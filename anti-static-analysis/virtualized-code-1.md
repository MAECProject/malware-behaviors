|||
|---------|------------------------|
|**ID**|**B0001**|
|**Objective(s)**| [Anti-Static Analysis](https://github.com/MAECProject/malware-behaviors/tree/master/anti-static-analysis)|
|**Related ATT&CK Technique(s)**| None|


Virtualized Code
================
Virtualizes original executable code by translating the code into a special format that only a special virtual machine can run. It then inserts a "stub" function to call the VM where the actual code was supposed to be ran. This makes static analysis and reverse engineering more difficult; dumped code wonâ€™t work without VM code. Could also include virtualized packer stub code.

Virtualized code is a software protection technique. A commercial offering is Themida. WPProtect is an open source tool. [[1]](#1) 

Methods
-------
* **Multiple VMs**: multiple virtual machines with different architectures (CISC, RISC, etc.) can be used inside of a single executable in order to make reverse engineering even more difficult.

Malware Examples
----------------
|Name|Date|Description|
|-----------------------------|--------|-----------------------------|
| Locky Bart | January 2017 | Code virtualization is added to the binary using WPProtect. [[2]](#2)

References
----------
<a name="1">[1]</a> https://github.com/xiaoweime/WProtect
<a name="2">[2]</a> https://blog.malwarebytes.com/threat-analysis/2017/01/locky-bart-ransomware-and-backend-server-analysis/