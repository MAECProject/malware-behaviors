|||
|---------|------------------------|
|**ID**|**M0012**|
|**Objective(s)**| [Anti-Static Analysis](https://github.com/MAECProject/malware-behaviors/tree/master/anti-static-analysis)|
|**Related ATT&CK Technique(s)**|None|


Defeat Disassembler
===================
Defeats disassembly of the malware instance in a recursive or linear disassembler. Some methods apply to both types of disassemblers; others apply to one type and not the other.

Methods
-------
* **Conditional Misdirection**: Conditional jumps are sometimes used to confuse disassembly engines, resulting in the wrong instruction boundaries and thus wrong mnemonic and operands; identified when jmp/jcc to a label+# (e.g., JNE loc_401345fe+2).
* **Value Dependent Jumps**: Explicit use of computed values for control flow, often many times in the same basic block or function.
* **Argument Obfuscation**: simple number or string arguments to API calls are calculated at runtime, making linear disassembly more difficult.
* **Variable Recomposition**: Variables, often strings, are broken into multiple parts and store out of order, in different memory ranges, or both. They must then be recomposed before use.
* **VBA Stomping**: Typically, VBA source code is compiled into P-code, which is stored with compressed sourced code in the OLE file with VBA macros [[3]](#3). VMA Stomping - when the VBA source code is wiped and only the P-code remains - makes analysis much harder. Analysis of a malicious VBA Office document without source code is in [[3]](#3).
   
Malware Examples
----------------
|Name|Date|Description|
|-----------------------------|--------|-----------------------------|

References
----------
<a name="1">[1]</a> http://staff.ustc.edu.cn/~bjhua/courses/security/2014/readings/anti-disas.pdf

<a name="2">[2]</a> http://www.kernelhacking.com/rodrigo/docs/blackhat2012-paper.pdf

<a name="3">[3]</a> https://isc.sans.edu/diary/Malicious+VBA+Office+Document+Without+Source+Code/24870
