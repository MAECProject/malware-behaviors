|||
|---------|------------------------|
|**ID**|**B2002**|
|**Objective(s)**| [Persistence](https://github.com/MAECProject/malware-behaviors/tree/master/persistence)|
|**Related ATT&CK Technique(s)**|[Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060)|


Registry Run Keys / Startup Folder
==================================
Malware may add an entry to the Windows Registry run keys or startup folder to enable persistence. [[1]](#1)

See ATT&CK: [**Registry Run Keys / Startup Folder**](https://attack.mitre.org/techniques/T1060). Additional methods related to malware persistence are given in the Methods section.

Methods
-------
* **Shutdown Event**: The shutdown event triggered by WinLogon can be registered by an application to allow a malicious DLL to execute every time the machine shuts down: when the machine is shutdown the malware will be loaded into memory; then it will download the primary malware and reinfect the machine. The malware will also lie dormant during incident reporting processes. To check whether malware has registered for login events, check the registry key: HKEY_LOCAL_MACHINESoftwareMicrosoftWindows NTCurrentVersionWinlogonNotify. If a subkey with any name exists and it has a "shutdown" value then the dll in the "DLLName" key will be launched during the shutdown process. [[2]](#2)

References
----------
<a name="1">[1]</a> https://threatvector.cylance.com/en_us/home/windows-registry-persistence-part-2-the-run-keys-and-search-order.html

<a name="2">[2]</a> https://isc.sans.edu/diary/Wipe+the+drive!++Stealthy+Malware+Persistence+-+Part+4/15460