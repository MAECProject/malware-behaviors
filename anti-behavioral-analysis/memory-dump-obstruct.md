|||
|---------|------------------------|
|**ID**|**B1005**|
|**Objective(s)**|[Anti-Behavioral Analysis](https://github.com/MAECProject/malware-behaviors/tree/master/anti-behavioral-analysis)|
|**Related ATT&CK Technique(s)**|None|

Memory Dump Obstruction
=======================
Malware hinders retrieval and/or discovery of the contents of the physical memory of the system on which the malware instance is executing [[1]](#1).

Methods
-------
* **Encryption**: Encrypts the executing malware instance code (in memory)
* **Erase the PE header from memory**
* **Hide virtual memory**: Hide arbitrary segments of virtual memory belonging to the malware instance.
* **SizeOfImage**
* **Tampering**: Erase or corrupt specific file parts to prevent rebuilding (header, packer stub, etc.).
* **Page Guard**: Blocks of code are encrypted individually, and decrypted temporarily only upon execution. AKA guard pages. One variant uses self-debugging to accomplish.
* **On-the-Fly APIs**: API address is resolved before each use to prevent complete dumping.
* **Byte Stealing**: Move or copy the first bytes / instructions of the original code elsewhere. AKA stolen bytes or code splicing. For example, a packer may incorporate the first few instructions of the original EntryPoint (EP) into its unpacking stub before the tail transition in order to confuse automated unpackers and novice analysts. This can make it harder for rebuilding and may bypass breakpoints if set prematurely.
* **Import Obfuscation**: Add obfuscation between imports calls and APIs (obfuscation, virtualization, stealing, etc.).
* **Feed Misinformation**: Report inaccurate data when the contents of the physical memory of the system on which the malware instance is executing is retrieved.
* **Hooking**: API behavior can be altered to prevent prevent memory dumps. See [Hooking](https://github.com/MAECProject/malware-behaviors/blob/master/anti-behavioral-analysis/hooking.md)

Malware Examples
----------------
|Name|Date|Description|
|-----------------------------|-----------|-----------------------------|

References
----------
<a name="1">[1]</a> J. Stuttgen, M. Cohen, Anti-forensic resilient memory acquisition, www.dfrws.org/sites/default/files/session-files/paper-anti-forensic_resilient_memory_acquisition.pdf
 