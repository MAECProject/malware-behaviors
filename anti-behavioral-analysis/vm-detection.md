
|||
|----|-----|
|**id**|mbc-124|
|**Name**|Virtual Machine Detection & Evasion|
|**Tactic**|Anti-behavioral Analysis|
|**Description**|Detects whether the malware instance is being executed in a virtual machine (VM). If so, conditional execution selects a benign execution path.|
|**Methods**|* Guest Process Testing: Virtual machines offer guest additions that can be installed to add functionality such as clipboard sharing. Detecting the process, via its name or other methods, responsible for these tasks is a technique employed by malware for detecting whether it is being executed in a virtual machine.<br/>* HTML5 Performance Object: In three browser families, it is possible to extract the frequency of the Windows performance counter frequency, using standard HTML and Javascript. This value can then be used to detect whether the code is being executed in a virtual machine, by detecting two specific frequencies commonly used in virtual but not physical machines.<br/>* Named System Object Checks: Virtual machines often include specific named system objects by default, such as Windows device drivers, which can be detected by testing for specific strings, whether found in the Windows registry or other places.|
|**Detection**||
|**Mitigation**||
|**References**|* Rebhip: https://www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html <br/> * Arobot:	http://www3.ca.com/securityadvisor/virusinfo/virus.aspx?id=37776|
